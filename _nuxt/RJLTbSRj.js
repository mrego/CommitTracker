import{_ as G}from"./CYeIyjzW.js";import{_ as H}from"./DdOBwrMr.js";import{h as W}from"./DUBobU3j.js";import{f as Y,l as J,k as K,h as w,p as z,q as Q,r as h,o as k,c as U,b as m,s as p,i as E,v as y,x as $,a as r,t as j,d as u,w as i,F as q,j as A}from"./B29pliZ2.js";import{f as X}from"./D2nGpDRe.js";import{_ as Z}from"./DlAUqK2U.js";const ee={class:"section"},te={class:"container content"},ne={class:"container content"},se={class:"title"},oe={class:"is-pulled-right"},le={class:"grid"},ae={class:"cve-description"},re=Y({__name:"list",setup(ue){const S=J(),M=K(),I=w([new Date("2000-01-01"),new Date]),C=w([]),o=w("version"),T=w({}),B=w(0),F=w("n/a"),x=w(!1);M.query.group_by&&(o.value=M.query.group_by),z(o,()=>{S.push({query:{group_by:o.value}})}),Q(async()=>{const d=await fetch("/cve/data.json");C.value=await d.json(),B.value=Object.keys(C.value).length;const e=Object.values(C.value).reduce((l,v)=>Math.max(l,new Date(v.published).getTime()),0);F.value=W(Date.now()-e,{largest:3})});const P=(d,e)=>{const l=[];for(const v of d)e(v)&&l.push(v);for(const v of d)e(v)||l.push(v);return l};return z(()=>[C.value,I.value,o.value],async()=>{var v,V,N,f,O,a,c;console.log("refresh"),x.value=!0;for(let s=0;s<5;s++)await new Promise(t=>{const n=requestAnimationFrame(()=>{cancelAnimationFrame(n),t()})});const d=Object.values(C.value).filter(s=>{const t=new Date(s.published);return t>=I.value[0]&&t<=I.value[1]});let e={},l=[];switch(o.value){case"version":for(const t of d){const n=t.version_fixed||"unknown";e[n]||(e[n]=[]),e[n].push(t)}break;case"version_major":for(const t of d){const n=((v=t.version_fixed)==null?void 0:v.split(".")[0])||"unknown";e[n]||(e[n]=[]),e[n].push(t)}break;case"year":for(const t of d){const n=((N=(V=t.version_dates)==null?void 0:V.stable)==null?void 0:N.split("-")[0])||"unknown";e[n]||(e[n]=[]),e[n].push(t)}break;case"month":for(const t of d){const n=((O=(f=t.version_dates)==null?void 0:f.stable)==null?void 0:O.split("-")[0])||"unknown",g=((c=(a=t.version_dates)==null?void 0:a.stable)==null?void 0:c.split("-")[1])||"01",b=`${n}-${g}`;e[b]||(e[b]=[]),e[b].push(t)}break;case"vrp_reward":const s=X("$,.0f");for(const t of d){const n=t.vrp_reward?`${s(t.vrp_reward)}`:"unknown";e[n]||(e[n]=[]),e[n].push(t)}break;case"severity":for(const t of d){const n=t.severity||"unknown";e[n]||(e[n]=[]),e[n].push(t)}break;case"component":for(const t of d){if(!t.components){e["<Private bug>"]||(e["<Private bug>"]=[]),e["<Private bug>"].push(t);continue}for(const n of t.components)e[n]||(e[n]=[]),e[n].push(t)}break}switch(o.value){case"version":l=Object.keys(e).sort((s,t)=>{const n=s.split("."),g=t.split("."),b=n.every(_=>!isNaN(_)),D=g.every(_=>!isNaN(_));if(b&&!D)return-1;if(!b&&D)return 1;if(!b&&!D)return s.localeCompare(t);for(let _=0;_<Math.min(n.length,g.length);_++){const L=parseInt(n[_]),R=parseInt(g[_]);if(L!=R)return R-L}return t-s});break;case"version_major":case"year":l=Object.keys(e).sort((s,t)=>parseInt(t)-parseInt(s)),l=P(l,s=>!isNaN(s));break;case"month":l=Object.keys(e).sort().reverse(),l=P(l,s=>!s.startsWith("unknown"));break;case"vrp_reward":l=Object.keys(e).sort((s,t)=>{const n=s.substring(1).replace(",",""),g=t.substring(1).replace(",","");return parseInt(g)-parseInt(n)}),l=P(l,s=>s!="$NaN"&&s!="unknown");break;case"severity":l=Object.keys(e).sort((s,t)=>s.localeCompare(t)),l=["Critical","High","Medium","Low","unknown"];break;case"component":l=Object.keys(e).sort((s,t)=>s.localeCompare(t)),l=P(l,s=>s!="<Private bug>");break}x.value=!1,T.value=l.map(s=>({key:s,cves:e[s].reverse()}))}),(d,e)=>{const l=G,v=h("b-loading"),V=h("b-tag"),N=H,f=h("b-radio-button"),O=h("b-field");return k(),U("div",null,[m(l),p(x)?(k(),E(v,{key:0,modelValue:p(x),"onUpdate:modelValue":e[0]||(e[0]=a=>y(x)?x.value=a:null),"is-full-page":!0},null,8,["modelValue"])):$("",!0),r("section",ee,[r("div",te,[e[21]||(e[21]=r("h1",{class:"title"},"Chromium CVEs",-1)),e[22]||(e[22]=r("p",null," The list of publicly known vulnerabilities in the Chromium project. This only includes the vulnerabilities that have been assigned a CVE number. Internally found vulnerabilities are not listed here. ",-1)),r("ul",null,[r("li",null,[r("strong",null,j(p(B))+" CVEs.",1)]),r("li",null,[e[8]||(e[8]=u("Last CVE published ")),r("strong",null,j(p(F))+" ago",1)]),e[12]||(e[12]=r("li",null,[u("Updates "),r("strong",null,"weekly"),u(".")],-1)),r("li",null,[e[10]||(e[10]=u(" Usually ")),m(V,{type:"is-danger is-small",class:"ml-2"},{default:i(()=>e[9]||(e[9]=[u(" Private bug ")])),_:1}),e[11]||(e[11]=u(" become public 14 weeks after they have been fixed. "))])]),e[23]||(e[23]=r("strong",null," Visualizations ",-1)),r("ul",null,[r("li",null,[m(N,{to:"/cve/reward_per_components"},{default:i(()=>e[13]||(e[13]=[u(" Per components rewards. ")])),_:1})])]),e[24]||(e[24]=r("div",{style:{"border-bottom":"1px solid #ccc","margin-bottom":"1em"}},null,-1)),m(O,{label:"Group by"},{default:i(()=>[m(f,{modelValue:p(o),"onUpdate:modelValue":e[1]||(e[1]=a=>y(o)?o.value=a:null),"native-value":"version"},{default:i(()=>e[14]||(e[14]=[u("Version")])),_:1},8,["modelValue"]),m(f,{modelValue:p(o),"onUpdate:modelValue":e[2]||(e[2]=a=>y(o)?o.value=a:null),"native-value":"version_major"},{default:i(()=>e[15]||(e[15]=[u("Version major")])),_:1},8,["modelValue"]),m(f,{modelValue:p(o),"onUpdate:modelValue":e[3]||(e[3]=a=>y(o)?o.value=a:null),"native-value":"year"},{default:i(()=>e[16]||(e[16]=[u("Year")])),_:1},8,["modelValue"]),m(f,{modelValue:p(o),"onUpdate:modelValue":e[4]||(e[4]=a=>y(o)?o.value=a:null),"native-value":"month"},{default:i(()=>e[17]||(e[17]=[u("Month")])),_:1},8,["modelValue"]),m(f,{modelValue:p(o),"onUpdate:modelValue":e[5]||(e[5]=a=>y(o)?o.value=a:null),"native-value":"vrp_reward"},{default:i(()=>e[18]||(e[18]=[u("Reward")])),_:1},8,["modelValue"]),m(f,{modelValue:p(o),"onUpdate:modelValue":e[6]||(e[6]=a=>y(o)?o.value=a:null),"native-value":"severity"},{default:i(()=>e[19]||(e[19]=[u("Severity")])),_:1},8,["modelValue"]),m(f,{modelValue:p(o),"onUpdate:modelValue":e[7]||(e[7]=a=>y(o)?o.value=a:null),"native-value":"component"},{default:i(()=>e[20]||(e[20]=[u("Component")])),_:1},8,["modelValue"])]),_:1})])]),(k(!0),U(q,null,A(p(T),a=>(k(),U("section",{class:"section",key:a.key},[r("div",ne,[r("h3",se,[u(j(a.key)+" ",1),r("div",oe,[m(V,{type:"is-info is-medium"},{default:i(()=>[u(j(a.cves.length)+" CVEs ",1)]),_:2},1024)])]),r("div",le,[(k(!0),U(q,null,A(a.cves,c=>(k(),U(q,null,[m(N,{to:"/cve?id="+c.id,class:"cve-link"},{default:i(()=>[u(j(c.id),1)]),_:2},1032,["to"]),r("div",ae,[c.bug_date?$("",!0):(k(),E(V,{key:0,type:"is-danger is-small",class:"ml-2"},{default:i(()=>e[25]||(e[25]=[u(" Private bug ")])),_:1})),c.vrp_reward?(k(),E(V,{key:1,type:"is-info is-small",class:"ml-2"},{default:i(()=>[u(j(c.vrp_reward)+"$ ",1)]),_:2},1024)):$("",!0),u(" "+j(c.description),1)])],64))),256))])])]))),128))])}}}),_e=Z(re,[["__scopeId","data-v-a97ddae8"]]);export{_e as default};
