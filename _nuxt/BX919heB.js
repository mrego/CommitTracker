import{_ as U}from"./CYeIyjzW.js";import{g as V,h as B}from"./DUBobU3j.js";import{f as F,k as P,l as O,h as x,q as I,r as M,o as m,c as h,b as k,a as s,d as D,t as f,s as r,i as N,w as T,F as b,x as y,j as S}from"./B29pliZ2.js";import{f as R}from"./D2nGpDRe.js";import{_ as J}from"./DlAUqK2U.js";var j={exports:{}};(function(w){(function(){var p={months:["January","February","March","April","May","June","July","August","September","October","November","December"],toUTC:function(o){var e=o?new Date(o):new Date;return e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),e},monthName:function(o){var e,n;return typeof o=="number"?e=o:(n=new Date(o),e=n.getMonth()+1),p.months[e-1]},relativeTime:function(o,e){var n,l,i,t,a,d,v,u,g=[];if(typeof o=="number"?n=o:(a=new Date(o),t=a.getTime(),d=new Date().getTime(),n=(d-t)/1e3*-1),e||(e={}),e.futureSuffix||(e.futureSuffix="from now"),e.pastSuffix||(e.pastSuffix="ago"),e.presentText||(e.presentText="now"),e.returnObject||(e.returnObject=!1),v=n<0,n=Math.abs(n),l={seconds:Math.floor(n%31536e3%86400%3600%60),minutes:Math.floor(n%31536e3%86400%3600/60),hours:Math.floor(n%31536e3%86400/3600),days:Math.floor(n%31536e3/86400),years:Math.floor(n/31536e3),past:v},e.returnObject)return l;if(n===0)return e.presentText;i=l.past?e.pastSuffix:e.futureSuffix,u=!0;function c(C,E){u&&(u=e.allUnits,g.push(C+" "+E+(C>1?"s":"")))}return l.years&&c(l.years,"year"),l.days&&c(l.days,"day"),l.hours&&c(l.hours,"hour"),l.minutes&&c(l.minutes,"minute"),l.seconds&&c(l.seconds,"second"),g.join(", ")+" "+i},prettyPrint:function(o,e){var n,l,i,t,a,d,v,u,g,c;return o?typeof o=="number"&&(o=new Date().setSeconds(o)):o=new Date,e||(e={}),e.showTime||(e.showTime=!1),n=new Date(o),i=n.getDate(),i>3&&i<21?t=i+"th":i%10===1?t=i+"st":i%10===2?t=i+"nd":i%10===3?t=i+"rd":t=i+"th",a=n.getFullYear(),d=this.monthName(n.getMonth()+1),l=d+" "+t+", "+a,u=n.getHours(),g=n.getMinutes(),c=u>=12?"pm":"am",u=u%12?u%12:12,g=g<10?"0"+g:g,v=u+":"+g+" "+c,e.showTime?l+" at "+v:l}};w.exports?w.exports=p:this.humandate=p})()})(j);var q=j.exports;const A=V(q),H={class:"section content"},L={class:"container"},Y={class:"title"},$={key:0,class:"grid"},z=["href"],W={class:"events"},G={class:"event"},K={class:"duration"},Q={class:"header"},X={class:"date"},Z=["href"],ee=["href"],te=["href"],se=F({__name:"index",setup(w){const p=R("$,.0f"),_=P();O();const o=x(_.query.id),e=x({}),n=x([]),l=i=>{const t=[];t.push({title:"CVE published",date:new Date(i.published)}),i.bug_date&&t.push({title:"Bug reported",date:new Date(i.bug_date)});for(const[a,d]of Object.entries(i.version_dates))t.push({title:`${a} version deployed.`,date:new Date(d)});t.sort((a,d)=>a.date-d.date);for(let a=1;a<t.length;a++)t[a].delta=t[a].date-t[0].date,console.log("delta = ",t[a].delta);return t};return I(async()=>{const t=await(await fetch("/cve/data.json")).json();let a=null;for(const d of Object.values(t))if(d.id==o.value){a=d;break}console.log(a),e.value=a,n.value=l(a)}),(i,t)=>{const a=U,d=M("b-tooltip"),v=M("b-tag");return m(),h("div",null,[k(a),s("section",H,[s("div",L,[s("h2",Y,[D(f(r(o))+" ",1),r(e).bug_date?(m(),N(v,{key:1,type:"is-info is-small",class:"ml-2"},{default:T(()=>t[1]||(t[1]=[D(" public ")])),_:1})):(m(),N(v,{key:0,type:"is-danger is-small",class:"ml-2"},{default:T(()=>[k(d,{label:"Bug are opened 14 weeks after being fixed",position:"is-top"},{default:T(()=>t[0]||(t[0]=[D(" Private bug ")])),_:1})]),_:1}))]),r(e).bug?(m(),h("div",$,[t[5]||(t[5]=s("strong",null,"Description",-1)),s("p",null,f(r(e).description),1),r(e).vrp_reward?(m(),h(b,{key:0},[t[2]||(t[2]=s("strong",null,"VRP reward",-1)),s("div",null,f(r(p)(r(e).vrp_reward)),1)],64)):y("",!0),t[6]||(t[6]=s("strong",null,"Bug ",-1)),s("a",{href:r(e).bug},f(r(e).bug),9,z),r(e).components?(m(),h(b,{key:1},[t[3]||(t[3]=s("strong",null,"Components",-1)),s("div",null,[(m(!0),h(b,null,S(r(e).components,u=>(m(),h("div",null,f(u),1))),256))])],64)):y("",!0),t[7]||(t[7]=s("strong",null,"Severity",-1)),s("div",null,f(r(e).severity),1),r(e).found_in?(m(),h(b,{key:2},[t[4]||(t[4]=s("strong",null,"Found in",-1)),s("div",null,f(r(e).found_in),1)],64)):y("",!0),t[8]||(t[8]=s("strong",null,"Version fixed",-1)),s("div",null,f(r(e).version_fixed),1),t[9]||(t[9]=s("strong",null,"Events",-1)),s("div",W,[(m(!0),h(b,null,S(r(n),u=>(m(),h("div",G,[s("div",K,f(r(B)(u.delta,{largest:2})),1),s("div",Q,f(u.title),1),s("div",X,f(r(A).prettyPrint(u.date)),1)]))),256))]),t[10]||(t[10]=s("strong",null,"Problem",-1)),s("div",null,f(r(e).problem),1),t[11]||(t[11]=s("strong",null,"CWE",-1)),s("a",{href:"https://cwe.mitre.org/data/definitions/"+r(e).cweId+".html"},f(r(e).cweId),9,Z),t[12]||(t[12]=s("strong",null,"Links",-1)),s("div",null,[s("div",null,[s("a",{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name="+r(o)},"MITRE",8,ee)]),s("div",null,[s("a",{href:"https://nvd.nist.gov/vuln/detail/CVE-"+r(o)},"NVD",8,te)])])])):y("",!0)])])])}}}),le=J(se,[["__scopeId","data-v-e73e4a1e"]]);export{le as default};
