import{s as c}from"./B6qCbaoP.js";import{f as B}from"./D2nGpDRe.js";import{b as x}from"./BxPoHLz2.js";import{i as q}from"./D-2-6Lyj.js";import{f as C,h as g,p as A,q as j,c as L,a as l,t as O,o as R}from"./B29pliZ2.js";function y(d){return Math.sqrt(1- --d*d)}const S={class:"line"},T={class:"left"},z=C({__name:"BarChart",props:{timeLabel:{type:String,default:""},data:{type:Array},formatter:{type:Function,default:B(",d")}},setup(d){const i=d,m=g(null),_=g(null),v=g(null),w=async()=>{v.value.formatter=i.formatter;const u=[];for(const t of i.data){let e=0;for(const r of t.values)e+=r.value;u.push(e)}let n=0;for(const t of u)n=Math.max(n,t);let p=n;for(const t of i.data)for(const e of t.values)e.value>0&&(p=Math.min(p,e.value));p=Math.max(p,1e-6);const b=t=>{t.transition().duration(e=>450).ease(x).style("width",(e,r)=>70*u[r]/n+"%")},M=t=>{t.transition().duration(450).ease(y).style("flex-grow",e=>e.value===0?0:Math.max(1,e.value/p)).style("background-color",e=>e.color)},k=async t=>{t.transition().duration(e=>350).textTween(function(e,r){const a=u[r],o=this._current;this._current=a;const s=v.value.formatter;if(o===void 0)return h=>s(a);if(o<=1&&a>=1)return h=>s(a);if(o>=1&&a<=1)return h=>s(a);const f=q(o,u[r]);return h=>s(f(h))})};c(_.value).selectAll(".line").data(i.data,t=>t.label).join(t=>{const e=t.append("div");e.classed("line",!0),e.style("filter","blur(4px)").style("height","0px").style("opacity",.3).style("transform","translate(-32px, 0)").transition().duration((s,f)=>450+30*Math.sqrt(f)).ease(x).style("height","24px").style("transform","translate(0px, 0)").style("filter","blur(0px)").transition().duration(s=>450).ease(x).style("filter","none").style("opacity",1).style("filter","none");const r=e.append("div");r.classed("left",!0),r.text(s=>s.label);const a=e.append("div");a.classed("center",!0),b(a);const o=e.append("div");return o.classed("right",!0),o.text(0),o.property("_current",s=>0),k(o),e},t=>{const e=t.select(".center");b(e);const r=t.select(".right");return k(r),t},t=>{t.transition().duration((e,r)=>350).delay((e,r)=>500-30*Math.sqrt(r)).ease(y).style("opacity","0.2").style("filter","blur(3px)").transition().duration((e,r)=>150).ease(y).style("transform","translate(64px, 0)").style("height","0px").style("opacity","0").remove()}).select(".center").selectAll(".repository").data(t=>t.values,t=>t.label).join(t=>{const e=t.append("div");return e.classed("repository",!0).style("flex-grow",0),M(e),e.on("mouseover",function(r,a){const o=c(this).node().getBoundingClientRect(),s=c(m.value).select(".tooltip-inner");c(m.value).transition().duration(200).ease(y).style("opacity",1).style("left",o.left+o.width/2+"px").style("top",o.top+"px");const f=v.value.formatter;s.text(a.label+": "+f(a.value))}),e},t=>(M(t),t),t=>t.transition().duration(450).ease(y).style("flex-grow",0).remove())};return A(()=>i.data,w),j(()=>{c(_.value).on("mouseout",()=>{c(m.value).transition().duration(600).delay(1e3).style("opacity",0)}),v.value={formatter:i.formatter},w()}),(u,n)=>(R(),L("div",null,[l("div",S,[l("div",T,[l("strong",null,O(d.timeLabel),1)]),n[0]||(n[0]=l("div",{class:"right"},[l("strong",null,"# commit")],-1))]),l("div",{ref_key:"histogram",ref:_,class:"histogram"},null,512),l("div",{ref_key:"tooltip",ref:m,class:"tooltip"},n[1]||(n[1]=[l("div",{class:"tooltip-inner"},"Test",-1),l("div",{class:"tooltip-arrow"},null,-1)]),512)]))}});export{z as _};
