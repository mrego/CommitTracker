import{_ as O}from"./CYeIyjzW.js";import{_ as P}from"./NxUEi_18.js";import{f as j,m as W,g as G,h as v,r as _,o as i,i as S,w as f,c as b,F as A,j as U,b as r,d as l,t as Z,k as I,l as J,n as N,p as Y,q as H,a as e,s,v as x,x as y}from"./B29pliZ2.js";import"./DlAUqK2U.js";import"./CTRyl4Lp.js";const K=j({__name:"TimeRangeSelector",props:W({label:{default:"",type:String,required:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(R){const u=G(R,"modelValue"),w=[["forever"],["1y+4y","1y+3y","1y+2y","1y+1y","1y"],["6m","3m","1m","1w"]];return v(w.flat()),(d,n)=>{const m=_("b-radio-button"),c=_("b-field");return i(),S(c,{grouped:"",label:"Time range:"},{default:f(()=>[(i(),b(A,null,U(w,(p,V)=>r(c,{key:V,class:"has-addons"},{default:f(()=>[(i(!0),b(A,null,U(p,h=>(i(),S(m,{key:h,modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=g=>u.value=g),"native-value":h},{default:f(()=>[l(Z(h),1)]),_:2},1032,["modelValue","native-value"]))),128))]),_:2},1024)),64))]),_:1})}}}),Q={class:"fullscreenFlexbox"},X={class:"section zoom"},ee={key:0,class:"section"},te={class:"container"},oe={key:1,class:"zoomable"},le={key:2,class:"container"},de=j({__name:"communities",setup(R){const u=I(),w=J(),d=v(["v8"]),n=v("forever"),m=v(1),c=v(!1),p=v(!1),V=v(null);u.query.repositories&&(d.value=u.query.repositories.split(",")),u.query.time&&(n.value=u.query.time),u.query.zoom&&(m.value=parseFloat(u.query.zoom));const h=N(()=>`${d.value.length==1?d.value:"all"}_${n.value}.svg`),g=N(()=>"/community-map/"+h.value),F=()=>{window.open(g.value,"_blank")},B=()=>{const o=document.createElement("a");o.href=g.value,o.download=h.value,o.click()},D=async()=>{if(g.value==V.value)return;V.value=g.value;const o=await fetch(g.value);if(o.ok){p.value=!1;const t=await o.text(),k=new DOMParser().parseFromString(t,"image/svg+xml").querySelector("svg");if(!k)return;document.querySelector("svg").replaceWith(k)}else p.value=!0},T=async()=>{await D(),E()},E=()=>{const o=document.querySelector("svg");o.setAttribute("preserveAspectRatio","xMinYMin meet"),o.setAttribute("margin","auto"),o.setAttribute("aspect-ratio","2"),o.setAttribute("width",m.value*95+"vw")};return Y([n,m,d],()=>{w.replace({query:{time:n.value,zoom:m.value,repositories:d.value.join(",")}}),T()}),H(()=>{T()}),(o,t)=>{const z=O,M=P,k=K,q=_("b-button"),C=_("b-field"),L=_("b-slider"),$=_("b-message");return i(),b("div",Q,[r(z),e("section",X,[r(M,{modelValue:s(d),"onUpdate:modelValue":t[0]||(t[0]=a=>x(d)?d.value=a:null),size:"small",allowMultiple:!1,allowAll:!0,filter:a=>a.reviewers},null,8,["modelValue","filter"]),r(k,{modelValue:s(n),"onUpdate:modelValue":t[1]||(t[1]=a=>x(n)?n.value=a:null)},null,8,["modelValue"]),r(C,{grouped:""},{default:f(()=>[r(C,{grouped:""},{default:f(()=>[r(q,{label:"Readme",onClick:t[2]||(t[2]=a=>c.value=!s(c)),type:"is-warning"}),s(p)?y("",!0):(i(),S(q,{key:0,onClick:F,type:"is-info",label:"View"})),s(p)?y("",!0):(i(),S(q,{key:1,onClick:B,type:"is-info is-light"},{default:f(()=>t[5]||(t[5]=[l(" Download ")])),_:1}))]),_:1}),r(C,{label:"Zoom","label-position":"on-border",expanded:""},{default:f(()=>[r(L,{modelValue:s(m),"onUpdate:modelValue":t[3]||(t[3]=a=>x(m)?m.value=a:null),min:.1,max:6,step:.05,tooltip:!1,lazy:"",indicator:""},null,8,["modelValue"])]),_:1})]),_:1})]),s(c)?(i(),b("section",ee,[e("div",te,[r($,{title:"Readme",modelValue:s(c),"onUpdate:modelValue":t[4]||(t[4]=a=>x(c)?c.value=a:null),"aria-close-label":"Close message"},{default:f(()=>t[6]||(t[6]=[e("div",{class:"content"},[e("ul",null,[e("li",null,[l(" Data is refreshed "),e("strong",null,"weekly"),l(", and "),e("strong",null,"automatically"),l(". See "),e("a",{href:"https://github.com/ArthurSonzogni/ChromeCommitTracker/actions/workflows/importer-graph.yaml"}," Job ")]),e("li",null,[e("strong",null,"Label height"),l(" is proportional to the number contributions square root (author + review). The goal is to make the surface used to draw one characters proportional to the number of commits. ")]),e("li",null,[e("strong",null,"Edge thickness"),l(' is proportional to the number of commit flowing from one author to a reviewer. We ignore long distance edges with a low number of commit. To be precise, there is a "commit" / "length" threshold. The "real" graph is extremly dense and difficult to interpret. ')]),e("li",null,[e("strong",null,"Edge orientation"),l(" helps understanding who is the author and who is the reviewer. The edge turn left when going from the author to the reviewer. ")]),e("li",null,[e("strong",null,"Colors"),l(" represent different communities who strongly interact together, and do not outside Often, the number of communities is high when considering small range of time (small project), and low when considering large range of time (large product). We are using the "),e("a",{href:"https://en.wikipedia.org/wiki/Louvain_method"}," Louvain algorithm "),l(". "),e("li",null,[e("strong",null,"Code reviews before 2017 are not included."),l(", the data wasn't part of the commit description before. ")])])])],-1)])),_:1},8,["modelValue"])])])):y("",!0),s(p)?y("",!0):(i(),b("div",oe,t[7]||(t[7]=[e("svg",null,null,-1)]))),s(p)?(i(),b("p",le,t[8]||(t[8]=[l(" No data for this selection. Try to select a larger time range, or a different repository."),e("br",null,null,-1),l(" Please note that this relies on the commit description. If the commit description doesn't contains some `Reviewed-by` or tags, the data will be incomplete. ")]))):y("",!0)])}}});export{de as default};
